\section{Lezione 12 - 19/04/2023}

\subsection{Teorema di Rouché-Capelli}
Il teorema di Rouché-Capelli anche noto come secondo sistema di compatibilità afferma che un sistema $S$ è compatibile $\Leftrightarrow$ il rango della matrice incompleta è uguale al rango della matrice completa.
$$
\syssubstitute{A{a_{11}}B{a_{21}}C{a_{m1}}D{a_{1n}}E{a_{2n}}F{a_{mn}}X{x_{n}}}
\systeme{
  A x_1 +...+ D X  = c_1,
  B x_1 +...+ E X = c_2,
  C x_1 +...+ F X = c_n
}
\; \text{è compatibile} \Leftrightarrow
v(A) = v(A^{\prime})
$$

\textbf{DIM $\Rightarrow$:}
Per il primo principio compatibilità:
$$ 
\begin{pmatrix}
c_1 \\ \vdots \\ c_n
\end{pmatrix}
=
y_1 \begin{pmatrix}
a_{11} \\ \vdots \\ a_{n1}
\end{pmatrix}
+...+
y_n \begin{pmatrix}
a_{1m} \\ \vdots \\ a_{nm}
\end{pmatrix}
$$
$$ (c_1,...,c_n) \; \text{DIPENDE DALLE COLONNE}$$
DA FINIRE
\textbf{DIM $\Leftarrow$:}
Partiamo da "i due ranghi sono uguali" allora per il teorema degli orlati hanno lo stesso ordine/grado $(L)$.\\
Consideriamo una matrice:
$$
\begin{pmatrix}
a_{11} & \dots & a_{1n} &\aug& c_1 \\
\vdots & \ddots & \vdots &\aug& \vdots \\
a_{n1} & \dots & a_{nm} &\aug& c_n 
\end{pmatrix}
$$
Consideriamo un minore fondamentale della matrice incompleta (base), ma dalla ipotesi lo è anche per la matrice completa.\\
Allora per il teorema degli orlati: le colonne del minore fondamentale formano un sistema di generatori di tutta la matrice allora il sistema è compatibile-

\subsubsection{Esempio Parametrico}
Consideriamo il seguente sistema:
$$ 
\systeme{
x+y+zh = 2,
2x+3y+z = 1,
x+5y+z = 0
}
$$
Abbiamo un fattore \textbf{parametrico} cioé $h$, vogliamo sapere per quali valori di $h$ il sistema è compatibile:\\
Potremmo procedere con la risoluzione a gradini ma ci viene più facile con Rusché-Capelli, costruiamo la matrice:
$$ 
\begin{pmatrix}
1 & 1 & h & \aug & 2 \\
2 & 3 & 1 & \aug & 1 \\
1 & 5 & 1 & \aug & 0
\end{pmatrix}
$$
Comincio a trovare il minore fondamentale della matrice incompleta, come sempre iniziamo dal "basso" quindi consideriamo $1$ nella posizione $3;1$ e andiamo ad orlarlo:
$$
A(2,3;1,2) = 
\begin{pmatrix}
2 & 3 \\
1 & 5
\end{pmatrix}
$$
Dalla definizione di minore fondamentale abbiamo bisogno che il suo determinante sia diverso da zero ($2*5-1*3 \neq 0$) e che tutti i suoi orlati abbiano determinante uguale a 0, in questo caso l'unico orlato possibile (della matrice incompleta) è:
$$
A(1,2,3;1,2,3) = 
\begin{pmatrix}
1 & 1 & h \\
2 & 3 & 1 \\
1 & 5 & 1
\end{pmatrix}
$$
Per calcolare il determinante usiamo $Sorrus$ ci verrà:
$$ 3+1+10h - 3h-2-5 = 7h-3 $$
Essendo che il determinante è anch'esso parametrico abbiamo due casi:
\begin{itemize}
\item[] SE $h=\frac{3}{7}$ allora il $det = 0$ quindi il rango sarà $2$
\item[] SE $h \neq \frac{3}{7}$ allora il $det \neq 0$ quindi il rango sarà $3$
\end{itemize}
(Ovviamente nel caso $h \neq \frac{3}{7}$ il minore fondamentale è la matrice stessa)
Ora dobbiamo trovare il rango della matrice completa, come sempre dobbiamo trovare un minore fondamentale:
$$ 
A(1,2,3;1,2,4) =
\begin{pmatrix}
1 & 1 & 2 \\
2 & 3 & 1 \\
1 & 5 & 0
\end{pmatrix}
$$
Il determinante è diverso da zero quindi è un minore fondamentale, quindi il rango della matrice completa è $3$.\\
Per il teorema di Rusché-Capelli il sistema è compatibile se e solo se il rango delle due matrice combacia ma essendo il rango della matrice incompleta parametrico abbiamo due casi:
\begin{itemize}
\item[]SE $h = \frac{3}{7}$ $ 3 \neq 2 $ INCOMPATIBILE
\item[]SE $h \neq \frac{3}{7}$ $ 3 \neq 3 $ COMPATIBILE (rango massimo)
\end{itemize}
Sappiamo che per $h \neq \frac{3}{7}$ il sistema è compatibile ora bisogna trovare le soluzioni, usiamo la seguente tecnica:
$$ AX=C $$
Sappiamo che $A$ ha determinante diverso da zero allora è invertibile allora sfruttando quello che abbiamo visto a 9.3, sappiamo che le soluzioni $X=A^{-1}C$, allora:
$$ 
A^{-1} =  \frac{1}{7h-3} 
\begin{pmatrix}
A_{11} & A_{21} & A_{31} \\
A_{12} & A_{22} & A_{32} \\
A_{13} & A_{23} & A_{33}
\end{pmatrix}
$$
Ricordiamo che $A_{11}...$ sono i complementi algebrichi.
$$ 
A^{-1} =
\begin{pmatrix}
-2 & 1-h5 & 1-3h \\
1 & 1h & 1*2h \\
7 & 4 & 1
\end{pmatrix}
$$
Quindi ora possiamo esprimere $X$ come:
$$
X = \begin{pmatrix}
X \\ X \\ X
\end{pmatrix}
=
\begin{pmatrix}
-2 & 1-h5 & 1-3h \\
1 & 1h & 1*2h \\
7 & 4 & 1
\end{pmatrix}
*
\begin{pmatrix}
2 \\ 1 \\ 0
\end{pmatrix}
$$

\subsection{Regola di Cramer}
La Regola(Metodo) di Cramer ci dà una mano nel trovare le soluzione di sistema di equazione di \textbf{n equazione, n incognite}.\\
Se ci sono $n$ equazioni ed $n$ incognite sappiamo che la matrice
incompleta è una matrice quadrata, e poiché le righe della matrice quadrata sono indipendenti poiché fanno sempre parte del minore fondamentale, la matrice $A$ ha determinante diverso da zero, questo implica che possiamo invertirla, quindi:
$$ AX=C \Rightarrow X=A^{-1}C $$
Esperiamiamo:
$$ 
\begin{pmatrix}
X_1 \\ \vdots \\ X_n
\end{pmatrix}
= 
\frac{1}{detA = |A|}
\begin{pmatrix}
A_{11} & A_{21} & \dots & A_{n1} \\
A_{12} & \ddots & \dots & \vdots \\
A_{1m} & A_{23} & \dots & A_{nm}
\end{pmatrix}
\begin{pmatrix}
C_1 \\ \vdots \\ C_n
\end{pmatrix}
=
$$
$$ 
=
\begin{pmatrix}
C_1A_{11}+C_2A_{21}+...+C_nA_{n1} \\
\vdots \\
C_1A_{1m}+C_2A_{2m}+...+C_nA_{nm} 
\end{pmatrix}
$$
Infine dalla eguaglianza:
$$ x_1 = \frac{c_1A_{11}+...+c_nA_{n1}}{|A|} $$
%$$ \; \vdots $$
$$ x_n = \frac{c_1A_{1n}+...+c_nA_{nm}}{|A|} $$

\subsection{Cramer Semplificato}
Un metodo più semplice prevede di far utilizzo di una matrice ausiliaria andando a sostituire alla $i$-sima colonna i termini noti.\\
Nello specifico se vogliamo calcolarci $x_1$ andremo a sostituire alla prima colonna, la colonna dei termini noti in questo modo:
$$
B_1 = 
\begin{pmatrix}
c_{11} & a_{12} & \dots & a_{1n} \\
c_{21} & \ddots & \vdots & \vdots \\
\vdots & \vdots & \ddots & \vdots \\
c_{n1} & \dots & \dots & a_{nn}
\end{pmatrix}
$$
Ne consegue che a $B_2$ andrà sostituita la seconda colonna e così via...\\
Tornando a $B_1$ se andiamo a calcolare il determinante della prima colonna (che è anche il determinante della matrice stessa) otteremo:
$$ c_1A_{11}+...+c_nA_{n1} $$
che è proprio il numeratore della regola di Cramer, quindi possiamo semplificare nel seguenti modo:
$$ x_1 = \frac{|B_1|}{|A|} $$

\subsubsection{Esempio}
Riprendiamo l'esempio di prima:
$$
(h \neq \frac{3}{7}) \; S =  
\systeme{
x+y+zh = 2,
2x+3y+z = 1,
x+5y+z = 0
}
$$
Dato che ci troviamo nella situazione di $n$ equazioni, $n$ incognite possiamo applicare Cramer, ci aiutiamo usando la matrice ausilaria:
$$ 
B_1 = 
\begin{pmatrix}
2 & 1 & h \\
1 & 3 & 1 \\
0 & 5 & 1 
\end{pmatrix} \; |B_1| = 5h-5
\; \; \; \; \; x_1 = \frac{5h-5}{7h-3} 
$$

$$
B_2 = 
\begin{pmatrix}
1 & 2 & h \\
2 & 1 & 1 \\
1 & 0 & 1 
\end{pmatrix} \; |B_2| = h+4-1-4
\; \; \; \; \; x_2 = \frac{h-1}{7h-3} 
$$

$$
B_3 = 
\begin{pmatrix}
1 & 1 & 2 \\
2 & 3 & 1 \\
1 & 5 & 0 
\end{pmatrix} \; |B_3| = 1+20-6-5
\; \; \; \; \; x_3 = \frac{10}{7h-3} 
$$

\subsection{Caso n equazioni, m incognite}
Consideriamo un sistema lineare con $n$ equazioni e $m$ incognite:
$$
\syssubstitute{A{a_{11}}B{a_{21}}C{a_{n1}}D{a_{1m}}E{a_{2n}}F{a_{nm}}X{x_{m}}}
S=
\systeme{
  A x_1 +...+ D X  = c_1,
  C x_1 +...+ F X = c_n
}
$$
Usiamo Rushé-Capelli per verificare la compatibilità del sistema (supponiamo di sì), sempre per lo stesso teorema abbiamo trovato un minore fondamentale, essendo una base possiamo rimuovere tutte le righe aldifuori di quelle del minore fondamentale, quindi siamo rimasti con solo righe indipendenti, portiamo tutte le colonne che non fanno parte del minore fondamentale dal lato dei termini noti (tipo variabili liberi), possiamo considerare tutto quello che c'è a destra come un solo numero, in questo modo ci siamo riportati nel caso di $n$ equazioni, $n$ incognite quindi possiamo applicare Cramer come abbiamo visto sopra.

\subsubsection{Esempio}
Per capire meglio consideriamo il seguente sistema:
$$ 
\systeme
{
x+y+z = 2,
2x+3y+z=1,
3x+4y+2z=3
}
$$
Possiamo "subito" individuare il minore fondamentale e cancellare le righe al difuori:
$$ 
\systeme
{
\mathcolorbox{cyan}{x+y}+z = 2,
\mathcolorbox{cyan}{2x+3y}+z=1
}
$$
Portiamo a "destra" tutte le colonne al difuori del minore fondamentale ($det = 1$):
$$ 
\systeme
{
x+y = 2-z,
2x+3y=1-z
}
$$
Consideriamo tutti i valori a "destra" come un solo numero:
$$ 
\systeme
{
x+y = c_1,
2x+3y=c_2
}
$$
Ora possiamo applicare Cramer essendo $n$-equazioni, $n$-incognite:
%\footnote{Da come si nota era già  $n$-equazioni, $n$-incognite, ma il prof ha fatto questo esempio a lezione}:
$$ 
x = \frac{|B_1|}{|A|} = \frac{|\begin{pmatrix}c_1 & 1 \\ c_2 & 3\end{pmatrix}|}{1} = (c_1*3)-c_2
$$
$$
y = \frac{|B_2|}{|A|} = \frac{|\begin{pmatrix}1 & c_1  \\ 2 & c_2\end{pmatrix}|}{1} = c_2-(2*c_1)
$$
Ora possiamo a sostituire in $c_1$ e $c_2$ i valori originali:
$$ x = (2-z)*3 -(1-z) = 6-3z-1+z = -2z +5  $$
$$ y = (1-z)-2*(2-z) = 1-z-4+2z = z-3$$
Quindi alla fine il sistema $S$ ha:
$$ \infty^1 SOLUZIONI \;\;\; \overline{S} = \{(-2z+5,z-3,z)/ z \in \mathbb{R}\}$$
Si può procedere anche in maneria più semplice tramite sostituzione.

\subsection{Sistemi Lineari Omogenei}
Sia $S$ un sistema lineare omogeneo (zero come termini noti) di questo tipo:
$$
\syssubstitute{A{a_{11}}B{a_{21}}C{a_{n1}}D{a_{1m}}E{a_{2n}}F{a_{nm}}X{x_{m}}}
S=
\systeme{
  A x_1 +...+ D X  = 0,
  C x_1 +...+ F X = 0
}
$$
Possiamo anche esprimerlo come $S: AX=0$.\\
Vogliamo dimostrare che l ’insieme delle soluzioni rappresenta un sottospazio vettoriale di $\mathbb{R}^m$, ovvero $\overline{S} \le \mathbb{R}^m$.\\

\textbf{Dim:}
\begin{itemize}

\item[] \textbf{Vettore Nullo:}\\
Banale poiché ogni sistema \textbf{omogeneo} ammette almeno la soluzione banale $(0,...,0)$.

\item[] \textbf{Stabile $+$:}\\
Per verificare che sia stabile rispetto alla somma prendiamo due soluzioni $Y_1,Y_2 \in \overline{S} \Rightarrow Y_1+Y_2 \in \overline{S}$ (righe) che essendo soluzioni del sistema omogeneo possiamo scrivere:
$$AY_1^t = 0 = AY_2^t$$
$$A(Y_1^t+Y_2^t) = A((Y_1+Y_2)^t) \Rightarrow Y_1+Y_2 \in \overline{S} $$
\item[] \textbf{Stabile $\cdot$:}\\
$$ A(hY_1^t) = h(AY_1^t) = h0 = 0 \Rightarrow hY_1^t \in \overline{S} $$
\end{itemize}

\subsubsection{Esempio (Continuo Spiegazione)}
Consideriamo il seguente sistema:
$$ 
\systeme
{
\mathcolorbox{cyan}{x+y}+2z+t=0,
\mathcolorbox{cyan}{x+2y}+z+5t=0
}
$$
Troviamo il minore fondamentale (base), come abbiamo visto sopra spostiamo a destra tutto quello al difuori dalle colonne del m.f.:
$$
\systeme
{
x+y = -2z-t,
x+2y= -z-5t
} 
$$
Applicando Cramer o per sostituzione troviamoci l'incognite:
$$
\systeme
{
x = -3z+3t,
y = z-4t
}
$$
Quindi abbiamo che l'insieme delle soluzione $\overline{S}$ è \textbf{sottospazio}:
$$ \infty^2 \;\;\;\;\; \overline{S}=\{(-3z+3t,z-4t,z,t)/ z,t \in \mathbb{R}\} $$
Potendo scegliere $z$ e $t$ in maniera arbitraria scegliamo i valori che rendano i vettori indipendenti,(usualmente si pone a $1$ una variabile e $0$ sulle altre prendendo tutte le possibilità).\\
Quindi per:
\begin{itemize}
\item[]$z=1,t=0 \Rightarrow (-3,1,1,0)$
\item[]$z=0,t=1 \Rightarrow (3,-4,0,1)$
\end{itemize}
Non ci resta che verificare che $<(-3,1,1,0),(3,-4,0,1)>$ sia sistema di generatore per dire che sia base:
TODO: LO È PER CRAMER CAPIRE IL PERCHÉ

\subsection{Sistema Omogeneo Associato}
Considerando un sistema $S$ (potenzialmente non omogeneo) esiste una relazione con un sistema omogeneo $S_0$ ad esso associato.\\
Esprimiamolo in forma matriciale:
$$ S: AX=C \;\;\;\;\; S_0: AX=0 $$
Enunciamo il seguente teorema: \textbf{Preso $Y \in S$ una soluzione del sistema $S$} allora:
\begin{itemize}
\item[1)] $\forall Z \in \overline{S}_0 \Rightarrow Y+Z \in \overline{S} $\\ \textbf{DIM:}\\
$A(Y+Z)= AY + AZ = C+0 = C$
\item[2)] $\forall Y^{\prime} \in \overline{S} \exists Z \in \overline{S}_0: Y^{\prime}=Y+Z$\\
\textbf{DIM:}\\
$Z=Y^{\prime}-Y \;\;\;\; AZ=A(Y^{\prime}-Y) = AY^{\prime}-AY = C-C = 0$
\end{itemize}

Questo teorema ci dice che se voglio descrivere l’insieme delle soluzioni del mio sistema $S$ basta trovarmi una singola soluzione per $S$ dopodiché vado a considerare il sistema omogeneo associato $S_0$, di quest’ultimo vado a trovare l’insieme delle soluzioni; e tutte le altre soluzioni si possono descrivere come somma dell’unica soluzione che mi sono trovato più una qualunque combinazione lineare degli elementi della base dello spazio delle soluzioni del sistema omogeneo.

\subsubsection{Esempio}
Consideriamo il sistema $S$ e i suo sistema omogeneo associato $S_0$:
$$
S=
\systeme
{
x+y+2z+t=1,
x+2y+z+5t=2
}
$$
$$
S_0=
\systeme
{
x+y+2z+t=0,
x+2y+z+5t=0
}
$$
Prendiamo una soluzione per $S$ cioé $x=0,y=1$ cioè la $n$-plua:
$$ (0,1,0,0) $$
Invece la soluzione per $S_0$ ce la siamo già trovati precendente cioè:
$$ \overline{S}_0 = <(-3,1,1,0),(3,-4,0,1)> $$
Avendo una soluzione per $S$ e tutte le soluzione di $S_0$ possiamo scrivere:
$$ \overline{S} = (0,1,0,0) + <(-3,1,1,0),(3,-4,0,1)> $$
Scriviamolo sottoforma di combinazione lineare:
$$ \overline{S} = \{(0,1,0,0) + h(-3,1,1,0)+k(3,-4,0,1)/h,k \in \mathbb{R}\} $$





